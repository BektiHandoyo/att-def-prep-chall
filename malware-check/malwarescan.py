#!/usr/bin/env python3

import sys
import os
import base64

def load_keywords(keyword_file):
    keywords = []
    try:
        with open(keyword_file, 'r', encoding='utf-8') as f:
            for line in f:
                keyword = line.strip()
                if keyword:
                    keywords.append(keyword.lower())
    except Exception as e:
        print(f"Error reading keyword file: {e}")
        sys.exit(1)
    return keywords

def is_malicious(file_path, keywords):
    try:
        with open(file_path, 'r', encoding='utf-8', errors='ignore') as f:
            content = f.read().lower()
            for keyword in keywords:
                if keyword in content:
                    return True
    except Exception as e:
        print(f"Error reading file: {e}")
        sys.exit(1)
    return False

def main():
    if len(sys.argv) != 2:
        print("Usage: malwarescan.py /path/to/file")
        sys.exit(1)
    file_path = sys.argv[1]
    if not os.path.isfile(file_path):
        print("Error: File does not exist.")
        sys.exit(1)
    keyword_file = os.path.join(os.path.dirname(__file__), 'keyword.txt')
    keywords = load_keywords(keyword_file)
    if is_malicious(file_path, keywords):
        print("Malware / Malicious File Detected!")
    else:
        print("File Probably Safe")

if __name__ == "__main__":
    main()